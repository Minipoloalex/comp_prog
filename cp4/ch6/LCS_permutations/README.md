This code should be tested as a module in a problem to ensure its correctness.
